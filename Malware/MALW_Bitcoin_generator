import "pe"
import "cuckoo"

rule MALW_Bitcoin_generator : Trojan
{
  meta:
		Author = "Tyler <@InfoSecTyler>"
		Description ="Rule to identify Bitcoin Generator Trojan"
    Reference ="https://www.hybrid-analysis.com/sample/fd20
                485905288c615076fa0eec8f7fce92180ba4bd0b86f506b94f305cd8b2fa?environmentId=100"

  strings:
    $file1="KeyActivator.exe" nocase
    $file2="SystemPem.exe" nocase
    $ind1="svchost.exe:Zone.Identifier" wide ascii
    $ind2="runll32.exe.config" wide ascii
    $ind3="Cab5B3C.tmp" wide ascii
    $ind4="Tar5B47.tmp" wide ascii

  condition:
    pe.entry_point == 0x002F5000 and
    cuckoo.network.http_request(/http\:\/\/repository\.uzto\.netdna\-cdn\.com/) and
    any of ($file*) and 
    any of ($ind*)
}
